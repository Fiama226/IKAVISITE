<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IKAVISITE - Gestion du flux des Visiteurs</title>
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1e40af;
            --primary-light: #dbeafe;
            --secondary: #64748b;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg-gradient-start: #f8fafc;
            --bg-gradient-end: #e2e8f0;
            --card-bg: rgba(255, 255, 255, 0.95);
            --shadow-sm: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
            --shadow-lg: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.05);
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            color: #1e293b;
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }
        
        .container {
            position: relative;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header */
        .header {
            text-align: center;
            margin-bottom: 60px;
            position: relative;
            z-index: 2;
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .logo {
            width: 60px;
            height: 60px;
            background: var(--primary);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 800;
            font-size: 1.5rem;
            box-shadow: var(--shadow-lg);
        }
        
        .header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            color: #0f172a;
            margin-bottom: 12px;
            letter-spacing: -0.02em;
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .header p {
            font-size: 1.1rem;
            color: #64748b;
            max-width: 700px;
            margin: 0 auto 30px;
            font-weight: 400;
        }
        
        .stats-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 30px;
        }
        
        .stat-item {
            background: white;
            padding: 15px 25px;
            border-radius: 12px;
            box-shadow: var(--shadow-sm);
            text-align: center;
            min-width: 150px;
            border-left: 4px solid var(--primary);
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
            display: block;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
        }

        /* Flow Container */
        .flow-wrapper {
            position: relative;
            min-height: 700px;
            margin: 0 auto;
        }

        /* Process Steps (Cards) */
        .step-card {
            position: absolute;
            width: 280px;
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
            z-index: 10;
            border: 1px solid transparent;
            backdrop-filter: blur(10px);
            cursor: pointer;
            margin-top: 10px;
        }

        .step-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: 0 25px 50px -12px rgba(37, 99, 235, 0.2);
            border-color: var(--primary-light);
        }

        .step-card.active {
            border: 2px solid var(--primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1), var(--shadow-lg);
        }

        .step-number {
            position: absolute;
            top: -12px;
            left: -12px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            font-weight: 800;
            font-size: 1rem;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            box-shadow: var(--shadow-lg);
            z-index: 20;
        }

        .step-icon {
            width: 70px;
            height: 70px;
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary-light), white);
            color: var(--primary);
            border-radius: 18px;
            box-shadow: 0 8px 16px rgba(37, 99, 235, 0.1);
            transition: var(--transition);
        }

        .step-card:hover .step-icon {
            transform: rotate(5deg) scale(1.1);
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
        }

        .step-icon svg {
            width: 32px;
            height: 32px;
            stroke-width: 1.8;
        }

        .step-title {
            text-align: center;
            font-weight: 700;
            font-size: 1.2rem;
            margin-bottom: 10px;
            color: #0f172a;
        }

        .step-desc {
            text-align: center;
            font-size: 0.9rem;
            color: #64748b;
            margin-bottom: 20px;
            line-height: 1.5;
            min-height: 60px;
        }

        .badges {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 8px;
            margin-top: 10px;
        }

        .badge {
            background-color: #f1f5f9;
            color: #475569;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.03em;
            transition: var(--transition);
        }

        .badge.highlight {
            background-color: var(--primary-light);
            color: var(--primary);
        }

        .step-card:hover .badge.highlight {
            background-color: var(--primary);
            color: white;
        }

        /* Positioning for desktop */
        #step-1 { top: 15%; left: 5%; }
        #step-2 { top: 15%; left: 50%; transform: translateX(-50%); }
        #step-3 { top: 15%; right: 5%; }
        #step-4 { top: 60%; right: 5%; }
        #step-5 { top: 60%; left: 50%; transform: translateX(-50%); }

        /* SVG Connectors */
        .connections-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        .connector-path {
            fill: none;
            stroke: #cbd5e1;
            stroke-width: 3px;
            stroke-linecap: round;
            transition: var(--transition);
        }

        .connector-path.active {
            stroke: var(--primary);
            stroke-width: 4px;
            filter: drop-shadow(0 2px 4px rgba(37, 99, 235, 0.2));
        }
        
        .connector-path.animated {
            stroke: var(--success);
            stroke-dasharray: 12 8;
            stroke-opacity: 0.6;
            animation: dash 20s linear infinite;
        }
        
        @keyframes dash {
            to {
                stroke-dashoffset: -1000;
            }
        }

        .connector-arrow {
            fill: #94a3b8;
            transition: var(--transition);
        }

        .connector-path.active + .connector-arrow {
            fill: var(--primary);
        }

        /* Process Controls */
        .process-controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 40px 0;
            flex-wrap: wrap;
        }
        
        .control-btn {
            background: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            color: var(--primary);
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .control-btn:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        .control-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .control-btn svg {
            width: 18px;
            height: 18px;
        }

        /* Footer */
        .footer {
            margin-top: 80px;
            text-align: center;
            color: #94a3b8;
            font-size: 0.875rem;
            border-top: 1px solid #e2e8f0;
            padding-top: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .footer-links {
            display: flex;
            gap: 20px;
        }
        
        .footer-link {
            color: #64748b;
            text-decoration: none;
            transition: var(--transition);
        }
        
        .footer-link:hover {
            color: var(--primary);
        }

        /* Modal for Step Details */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition);
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal {
            background: white;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            padding: 30px;
            box-shadow: var(--shadow-lg);
            transform: translateY(20px);
            transition: var(--transition);
        }
        
        .modal-overlay.active .modal {
            transform: translateY(0);
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: #0f172a;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--secondary);
            transition: var(--transition);
        }
        
        .close-modal:hover {
            color: var(--primary);
        }
        
        .modal-content p {
            margin-bottom: 20px;
            color: #64748b;
            line-height: 1.6;
        }
        
        .modal-features {
            list-style: none;
            margin: 20px 0;
        }
        
        .modal-features li {
            padding: 8px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .modal-features li:before {
            content: "✓";
            color: var(--success);
            font-weight: bold;
        }

        /* Mobile Responsive */
        @media (max-width: 1024px) {
            .flow-wrapper {
                height: auto;
                min-height: 500px;
                display: flex;
                flex-direction: column;
                align-items: center;
                gap: 30px;
            }
            
            .step-card {
                position: relative;
                top: auto !important;
                left: auto !important;
                right: auto !important;
                transform: none !important;
                margin-bottom: 20px;
                width: 90%;
                max-width: 400px;
            }
            
            .connections-layer {
                display: none;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .stats-container {
                gap: 10px;
            }
            
            .stat-item {
                min-width: 120px;
                padding: 12px 15px;
            }
            
            .stat-value {
                font-size: 1.5rem;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .stats-container {
                flex-direction: column;
                align-items: center;
            }
            
            .stat-item {
                width: 100%;
                max-width: 250px;
            }
            
            .footer {
                flex-direction: column;
                text-align: center;
            }
            
            .footer-links {
                flex-wrap: wrap;
                justify-content: center;
            }
        }

    </style>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
</head>
<body>

<div class="container">
    <div class="header">
        <div class="logo-container">
            <div class="logo"><img src="https://test.ikavisite.bf/public/backend/dist/img/logo.png" alt="" style="width: 50px;height: 50px;"></div>
            <h1>IKAVISITE</h1>
        </div>
        <h1>Flux de Gestion des Visiteurs</h1>
        <p>Flux opérationnel complet : de l'accueil à l'archivage sécurisé</p>
        
        <div class="stats-container">
            <div class="stat-item">
                <span class="stat-value">5</span>
                <span class="stat-label">Étapes Clés</span>
            </div>
            <div class="stat-item">
                <span class="stat-value">100%</span>
                <span class="stat-label">Sécurisé</span>
            </div>
            <div class="stat-item">
                <span class="stat-value">RGPD</span>
                <span class="stat-label">Conforme</span>
            </div>
            <div class="stat-item">
                <span class="stat-value">24/7</span>
                <span class="stat-label">Disponible</span>
            </div>
        </div>
    </div>

    <div class="process-controls">
        <button class="control-btn" id="start-process">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
            Démarrer la démo
        </button>
        <button class="control-btn" id="reset-process">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"></path>
                <path d="M3 3v5h5"></path>
            </svg>
            Réinitialiser
        </button>
    </div>

    <div class="flow-wrapper">
        <!-- SVG Connections -->
        <svg class="connections-layer" viewBox="0 0 1400 700">
            <defs>
                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#94a3b8" />
                </marker>
                <marker id="arrowhead-blue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#2563eb" />
                </marker>
            </defs>

            <!-- 1 -> 2 -->
            <path id="connector-1-2" d="M 280 200 H 700" class="connector-path" marker-end="url(#arrowhead)"/>
            
            <!-- 2 -> 3 -->
            <path id="connector-2-3" d="M 700 200 H 1120" class="connector-path" marker-end="url(#arrowhead)"/>
            
            <!-- 3 -> 4 (Vertical down) -->
            <path id="connector-3-4" d="M 1250 320 V 520" class="connector-path" marker-end="url(#arrowhead)"/>

            <!-- 4 -> 5 (Horizontal left) -->
            <path id="connector-4-5" d="M 1120 600 H 700" class="connector-path" marker-end="url(#arrowhead)"/>
            
            <!-- Loop Back (New Visit) -->
            <path id="connector-loop" d="M 700 600 Q 700 650 500 650 Q 250 650 250 400 Q 250 200 280 200" 
                  class="connector-path animated" 
                  fill="none" />
        </svg>

        <!-- Step 1: Arrivée -->
        <div class="step-card" id="step-1" data-step="1">
            <div class="step-number">01</div>
            <div class="step-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
            </div>
            <h3 class="step-title">Arrivée du Visiteur</h3>
            <p class="step-desc">Numérisation de pièce d'identité avec OCR et extraction IA. Vérification automatique des documents.</p>
            <div class="badges">
                <span class="badge highlight">Scan ID</span>
                <span class="badge">OCR IA</span>
                <span class="badge">Auto-remplissage</span>
            </div>
        </div>

        <!-- Step 2: Contrôle -->
        <div class="step-card" id="step-2" data-step="2">
            <div class="step-number">02</div>
            <div class="step-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                </svg>
            </div>
            <h3 class="step-title">Contrôle Sécurité</h3>
            <p class="step-desc">Vérification automatique liste noire et autorisations. Alertes en temps réel en cas de correspondance.</p>
            <div class="badges">
                <span class="badge highlight">Vérification</span>
                <span class="badge">Alertes</span>
                <span class="badge">Listes noires</span>
            </div>
        </div>

        <!-- Step 3: Enregistrement -->
        <div class="step-card" id="step-3" data-step="3">
            <div class="step-number">03</div>
            <div class="step-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                </svg>
            </div>
            <h3 class="step-title">Enregistrement</h3>
            <p class="step-desc">Création de visite, impression badge ou envoi QR Code. Notification à la personne visitée.</p>
            <div class="badges">
                <span class="badge highlight">Badge</span>
                <span class="badge">QR Code</span>
                <span class="badge">Notifications</span>
            </div>
        </div>

        <!-- Step 4: Dashboard -->
        <div class="step-card" id="step-4" data-step="4" style="margin-top: 100px;">
            <div class="step-number">04</div>
            <div class="step-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="3" y1="9" x2="21" y2="9"></line>
                    <line x1="9" y1="21" x2="9" y2="9"></line>
                </svg>
            </div>
            <h3 class="step-title">Suivi & Dashboard</h3>
            <p class="step-desc">Tableau de bord temps réel des présences et mouvements. Statistiques et reporting avancé.</p>
            <div class="badges">
                <span class="badge highlight">Temps Réel</span>
                <span class="badge">Monitoring</span>
                <span class="badge">Analytics</span>
            </div>
        </div>

        <!-- Step 5: Exit -->
        <div class="step-card" id="step-5" data-step="5" style="margin-top: 100px;">
            <div class="step-number">05</div>
            <div class="step-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="21 8 21 21 3 21 3 8"></polyline>
                    <rect x="1" y="3" width="22" height="5"></rect>
                    <line x1="10" y1="12" x2="14" y2="12"></line>
                </svg>
            </div>
            <h3 class="step-title">Sortie & Archivage</h3>
            <p class="step-desc">Clôture de la visite et archivage sécurisé (RGPD). Génération automatique des rapports.</p>
            <div class="badges">
                <span class="badge highlight">Historique</span>
                <span class="badge">Conformité</span>
                <span class="badge">RGPD</span>
            </div>
        </div>

    </div>

    <!-- Modal for Step Details -->
    <div class="modal-overlay" id="modal-overlay">
        <div class="modal">
            <div class="modal-header">
                <h2 class="modal-title" id="modal-step-title">Arrivée du Visiteur</h2>
                <button class="close-modal" id="close-modal">&times;</button>
            </div>
            <div class="modal-content">
                <p id="modal-step-desc">Numérisation de pièce d'identité avec OCR et extraction IA. Vérification automatique des documents.</p>
                <ul class="modal-features" id="modal-features">
                    <li>Scan haute définition des pièces d'identité</li>
                    <li>OCR intelligent avec correction automatique</li>
                    <li>Extraction des données avec vérification IA</li>
                    <li>Auto-remplissage des formulaires</li>
                </ul>
                <div class="badges" id="modal-badges"></div>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>© 2024 IKAVISITE. Tous droits réservés. Système certifié de gestion des visiteurs.</p>
        <div class="footer-links">
            <a href="http://ikasolution.bf/" class="footer-link">Contact</a>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const cards = document.querySelectorAll('.step-card');
        const connectors = document.querySelectorAll('.connector-path');
        const startBtn = document.getElementById('start-process');
        const resetBtn = document.getElementById('reset-process');
        const modalOverlay = document.getElementById('modal-overlay');
        const closeModal = document.getElementById('close-modal');
        let currentStep = 0;
        let animationInterval;
        
        // Step data for modal
        const stepDetails = {
            1: {
                title: "Arrivée du Visiteur",
                desc: "Processus d'accueil et d'identification du visiteur avec technologies avancées.",
                features: [
                    "Scan haute définition des pièces d'identité",
                    "OCR intelligent avec correction automatique",
                    "Extraction des données avec vérification IA",
                    "Auto-remplissage des formulaires",
                    "Vérification de l'authenticité des documents"
                ],
                badges: ["Scan ID", "OCR IA", "Auto-remplissage"]
            },
            2: {
                title: "Contrôle Sécurité",
                desc: "Vérifications de sécurité automatisées pour garantir la sûreté des locaux.",
                features: [
                    "Vérification contre les listes noires internes et externes",
                    "Contrôle des autorisations d'accès",
                    "Alertes en temps réel en cas de correspondance",
                    "Historique des incidents de sécurité",
                    "Intégration avec les systèmes de sécurité existants"
                ],
                badges: ["Vérification", "Alertes", "Listes noires"]
            },
            3: {
                title: "Enregistrement",
                desc: "Création du dossier visiteur et génération des accès nécessaires.",
                features: [
                    "Impression de badges personnalisés avec photo",
                    "Génération de QR codes pour accès mobiles",
                    "Notification automatique à la personne visitée",
                    "Signature numérique des accords de confidentialité",
                    "Enregistrement des informations de visite"
                ],
                badges: ["Badge", "QR Code", "Notifications"]
            },
            4: {
                title: "Suivi & Dashboard",
                desc: "Surveillance en temps réel et analytics des mouvements de visiteurs.",
                features: [
                    "Tableau de bord temps réel des présences",
                    "Tracking des mouvements dans les zones sécurisées",
                    "Statistiques et reporting avancé",
                    "Alertes de temps de visite dépassé",
                    "Export des données pour analyses"
                ],
                badges: ["Temps Réel", "Monitoring", "Analytics"]
            },
            5: {
                title: "Sortie & Archivage",
                desc: "Clôture sécurisée de la visite et archivage conforme RGPD.",
                features: [
                    "Clôture automatique ou manuelle de la visite",
                    "Archivage sécurisé des données personnelles",
                    "Génération automatique des rapports de visite",
                    "Purge automatique selon les durées légales",
                    "Conformité RGPD et audit des données"
                ],
                badges: ["Historique", "Conformité", "RGPD"]
            }
        };
        
        // Entrance animation
        cards.forEach((card, index) => {
            card.style.opacity = '0';
            card.style.transform = 'translateY(30px)';
            setTimeout(() => {
                card.style.transition = 'opacity 0.6s ease, transform 0.6s ease, box-shadow 0.3s ease';
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, index * 200);
        });
        
        // Step card hover effect
        cards.forEach(card => {
            card.addEventListener('click', () => {
                const step = card.getAttribute('data-step');
                openModal(step);
            });
            
            card.addEventListener('mouseenter', () => {
                const step = card.getAttribute('data-step');
                highlightConnectors(step, true);
            });
            
            card.addEventListener('mouseleave', () => {
                const step = card.getAttribute('data-step');
                highlightConnectors(step, false);
            });
        });
        
        // Start process button
        startBtn.addEventListener('click', () => {
            resetProcess();
            currentStep = 0;
            
            animationInterval = setInterval(() => {
                if (currentStep < cards.length) {
                    activateStep(currentStep + 1);
                    currentStep++;
                } else {
                    clearInterval(animationInterval);
                    // Show completion
                    setTimeout(() => {
                        alert("Processus terminé ! Toutes les étapes ont été complétées avec succès.");
                    }, 500);
                }
            }, 1500);
            
            startBtn.disabled = true;
        });
        
        // Reset process button
        resetBtn.addEventListener('click', resetProcess);
        
        // Modal functionality
        closeModal.addEventListener('click', () => {
            modalOverlay.classList.remove('active');
        });
        
        modalOverlay.addEventListener('click', (e) => {
            if (e.target === modalOverlay) {
                modalOverlay.classList.remove('active');
            }
        });
        
        // Functions
        function activateStep(stepNumber) {
            // Reset all cards
            cards.forEach(card => card.classList.remove('active'));
            connectors.forEach(connector => connector.classList.remove('active'));
            
            // Activate current step
            const currentCard = document.getElementById(`step-${stepNumber}`);
            if (currentCard) {
                currentCard.classList.add('active');
            }
            
            // Activate connectors leading to this step
            if (stepNumber > 1) {
                const connector = document.getElementById(`connector-${stepNumber-1}-${stepNumber}`);
                if (connector) connector.classList.add('active');
            }
        }
        
        function resetProcess() {
            clearInterval(animationInterval);
            cards.forEach(card => card.classList.remove('active'));
            connectors.forEach(connector => connector.classList.remove('active'));
            currentStep = 0;
            startBtn.disabled = false;
        }
        
        function highlightConnectors(step, highlight) {
            // Highlight incoming connector
            if (step > 1) {
                const incomingConnector = document.getElementById(`connector-${step-1}-${step}`);
                if (incomingConnector) {
                    incomingConnector.classList.toggle('active', highlight);
                }
            }
            
            // Highlight outgoing connector
            if (step < 5) {
                const outgoingConnector = document.getElementById(`connector-${step}-${parseInt(step)+1}`);
                if (outgoingConnector) {
                    outgoingConnector.classList.toggle('active', highlight);
                }
            }
            
            // Special case for step 5 (connects back to step 1)
            if (step == 5) {
                const loopConnector = document.getElementById('connector-loop');
                if (loopConnector) {
                    loopConnector.classList.toggle('active', highlight);
                }
            }
        }
        
        function openModal(step) {
            const details = stepDetails[step];
            if (!details) return;
            
            document.getElementById('modal-step-title').textContent = details.title;
            document.getElementById('modal-step-desc').textContent = details.desc;
            
            const featuresList = document.getElementById('modal-features');
            featuresList.innerHTML = '';
            details.features.forEach(feature => {
                const li = document.createElement('li');
                li.textContent = feature;
                featuresList.appendChild(li);
            });
            
            const badgesContainer = document.getElementById('modal-badges');
            badgesContainer.innerHTML = '';
            details.badges.forEach(badge => {
                const span = document.createElement('span');
                span.className = badge === 'Scan ID' || badge === 'Vérification' || badge === 'Badge' || 
                                badge === 'Temps Réel' || badge === 'Historique' ? 'badge highlight' : 'badge';
                span.textContent = badge;
                badgesContainer.appendChild(span);
            });
            
            modalOverlay.classList.add('active');
        }
        
        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                modalOverlay.classList.remove('active');
            }
        });
    });
</script>
</body>
</html>
